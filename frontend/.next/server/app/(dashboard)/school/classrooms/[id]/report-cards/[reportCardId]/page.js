(()=>{var e={};e.id=283,e.ids=[283],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1978:(e,t,r)=>{Promise.resolve().then(r.bind(r,6522))},2594:(e,t,r)=>{Promise.resolve().then(r.bind(r,6780))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4219:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var s=r(687);r(3210);var a=r(1391),o=r(9384);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,i=o.$;var d=r(6241);let l=((e,t)=>r=>{var s;if((null==t?void 0:t.variants)==null)return i(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:a,defaultVariants:o}=t,d=Object.keys(a).map(e=>{let t=null==r?void 0:r[e],s=null==o?void 0:o[e];if(null===t)return null;let i=n(t)||n(s);return a[e][i]}),l=r&&Object.entries(r).reduce((e,t)=>{let[r,s]=t;return void 0===s||(e[r]=s),e},{});return i(e,d,null==t||null==(s=t.compoundVariants)?void 0:s.reduce((e,t)=>{let{class:r,className:s,...a}=t;return Object.entries(a).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...o,...l}[t]):({...o,...l})[t]===r})?[...e,r,s]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)})("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c({className:e,variant:t,size:r,asChild:o=!1,...n}){let i=o?a.DX:"button";return(0,s.jsx)(i,{"data-slot":"button",className:(0,d.cn)(l({variant:t,size:r,className:e})),...n})}},4772:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,pages:()=>c,routeModule:()=>u,tree:()=>l});var s=r(5239),a=r(8088),o=r(8170),n=r.n(o),i=r(893),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(t,d);let l={children:["",{children:["(dashboard)",{children:["school",{children:["classrooms",{children:["[id]",{children:["report-cards",{children:["[reportCardId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,6780)),"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\classrooms\\[id]\\report-cards\\[reportCardId]\\page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,6675)),"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,8014)),"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\classrooms\\[id]\\report-cards\\[reportCardId]\\page.tsx"],h={require:r,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(dashboard)/school/classrooms/[id]/report-cards/[reportCardId]/page",pathname:"/school/classrooms/[id]/report-cards/[reportCardId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},6522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(687),a=r(3210),o=r(4219),n=r(9556),i=r(6189),d=r(3921);function l(e){return e>=40?"Good":e>=33?"Fairly Good":e>=25?"Average":"Poor"}let c=["khmerLiterature","mathematics","biology","chemistry","physics","history"];function h(){let e=(0,i.useParams)();e.id;let t=e.reportCardId,{t:r}=(0,d.o)(),h=(0,a.useMemo)(()=>c,[]),[u,p]=(0,a.useState)([]),[m,f]=(0,a.useState)(!1),[x,b]=(0,a.useState)(h),[y,g]=(0,a.useState)([]),[v,j]=(0,a.useState)(!1),[w,k]=(0,a.useState)(null),[N,C]=(0,a.useState)(null),[$,S]=(0,a.useState)({}),[E,P]=(0,a.useState)(!1),[T,F]=(0,a.useState)([]),[O,_]=(0,a.useState)(""),[A,z]=(0,a.useState)(!1),I=e=>{b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},q=e=>{g(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},J=(e,t,r)=>{S(s=>({...s,[e]:{...s[e],[t]:r}}))},D=async()=>{let e=O.trim();if(e&&!x.includes(e)&&!h.includes(e)&&!T.includes(e)){z(!0);try{await (0,n.Th)(e),F(t=>[...t,e]),b(t=>[...t,e]),_("")}catch{alert(r("failedToAddSubject"))}finally{z(!1)}}},G=async e=>{z(!0);try{await (0,n.bq)(e),F(t=>t.filter(t=>t!==e)),b(t=>t.filter(t=>t!==e))}catch{alert(r("failedToRemoveSubject"))}finally{z(!1)}},U=async()=>{P(!0);try{await (0,n.Nw)(t,x);let e=[...x],s=u.map(t=>e.reduce((e,r)=>{let s=Number($[t.id]?.[r]||0);return e+(isNaN(s)?0:s)},0)),a=[...s].map((e,t)=>({total:e,idx:t})).sort((e,t)=>t.total-e.total),o=Array(u.length).fill(0),i=1;for(let e=0;e<a.length;e++)e>0&&a[e].total===a[e-1].total?o[a[e].idx]=o[a[e-1].idx]:o[a[e].idx]=i,i++;let d={};u.forEach((t,r)=>{let a=s[r],n=e.length>0?(a/e.length).toFixed(2):"0",i=o[r],c={};e.forEach(e=>{c[e]=$[t.id]?.[e]||""}),d[t.id]={absent:$[t.id]?.absent||"",...c,total:String(a),average:String(n),grade:l(Number(n)),rank:String(i)}}),await (0,n.uN)(t,d),alert(r("successfullySavedScores"))}catch{alert(r("failedToSaveScores"))}finally{P(!1)}},M=[...x];return(0,s.jsxs)("section",{className:"w-full rounded-2xl bg-white p-7",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h1",{className:"text-xl font-semibold",children:N?.title||r("reportCard")}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(o.$,{className:"bg-[#25388C] hover:bg-[#1e2e6d] text-white",onClick:()=>f(!0),children:r("selectSubjects")}),(0,s.jsx)(o.$,{className:"bg-[#25388C] hover:bg-[#1e2e6d] text-white",onClick:U,disabled:E,children:E?r("saving"):r("save")})]})]}),w&&(0,s.jsx)("div",{className:"text-red-500 mb-4",children:w}),(0,s.jsx)("div",{className:"overflow-x-auto rounded-xl border border-gray-200 shadow-sm",children:(0,s.jsxs)("table",{className:"min-w-full text-sm text-left",children:[(0,s.jsx)("thead",{className:"bg-[#6C6F7F] text-white uppercase text-xs",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-3",children:(0,s.jsx)("input",{type:"checkbox",checked:v,onChange:()=>j(e=>!e)})}),(0,s.jsx)("th",{className:"px-4 py-3",children:r("name")}),(0,s.jsx)("th",{className:"px-4 py-3",children:r("absent")}),M.map(e=>(0,s.jsx)("th",{className:"px-4 py-3",children:r(e)},e)),(0,s.jsx)("th",{className:"px-4 py-3",children:r("total")}),(0,s.jsx)("th",{className:"px-4 py-3",children:r("average")}),(0,s.jsx)("th",{className:"px-4 py-3",children:r("grade")}),(0,s.jsx)("th",{className:"px-4 py-3",children:r("ranking")})]})}),(0,s.jsx)("tbody",{children:(()=>{let e=u.map(e=>M.reduce((t,r)=>{let s=Number($[e.id]?.[r]||0);return t+(isNaN(s)?0:s)},0)),t=[...e].map((e,t)=>({total:e,idx:t})).sort((e,t)=>t.total-e.total),a=Array(u.length).fill(0),o=1;for(let e=0;e<t.length;e++)e>0&&t[e].total===t[e-1].total?a[t[e].idx]=a[t[e-1].idx]:a[t[e].idx]=o,o++;return u.map((t,o)=>{let n=e[o],i=M.length>0?(n/M.length).toFixed(2):"0",d=a[o];return(0,s.jsxs)("tr",{className:"border-b",children:[(0,s.jsx)("td",{className:"px-4 py-2",children:(0,s.jsx)("input",{type:"checkbox",checked:y.includes(t.id),onChange:()=>q(t.id)})}),(0,s.jsx)("td",{className:"px-4 py-2",children:t.name}),(0,s.jsx)("td",{className:"px-4 py-2 text-center",children:(0,s.jsx)("input",{type:"text",className:"w-16 border rounded px-1 py-0.5 text-center",value:$[t.id]?.absent||"",onChange:e=>J(t.id,"absent",e.target.value)})}),M.map(e=>(0,s.jsx)("td",{className:"px-4 py-2 text-center",children:(0,s.jsx)("input",{type:"text",className:"w-16 border rounded px-1 py-0.5 text-center",value:$[t.id]?.[e]||"",onChange:r=>J(t.id,e,r.target.value)})},e)),(0,s.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:n}),(0,s.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:i}),(0,s.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:r({Good:"grade_good","Fairly Good":"grade_fairly_good",Average:"grade_average",Poor:"grade_poor"}[l(Number(i))]||"-")}),(0,s.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:d})]},t.id)})})()})]})}),(0,s.jsx)(o.$,{className:"mt-8 bg-[#25388C] hover:bg-[#1e2e6d] text-white font-semibold rounded-xl py-2 px-3 text-base",style:{minWidth:160},onClick:async()=>{try{await (0,n.QV)(t,y.length>0?y:u.map(e=>e.id)),alert(r("smsSentToParents"))}catch{alert(r("failedToSendSMS"))}},children:r("send")}),m&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/30 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-lg w-[400px] max-w-[90vw] relative",children:[(0,s.jsx)("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-black text-3xl",onClick:()=>f(!1),children:"\xd7"}),(0,s.jsx)("div",{className:"font-bold text-lg text-center mb-6",children:r("selectSubjects")}),(0,s.jsx)("div",{className:"flex flex-col gap-2 mb-4",children:[...h,...T].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:x.includes(e),onChange:()=>I(e)}),(0,s.jsx)("span",{children:r(e)}),T.includes(e)&&(0,s.jsx)("button",{type:"button",className:"ml-2 text-xs text-red-400 hover:text-red-600",onClick:()=>G(e),title:r("removeCustomSubject"),disabled:A,children:"\xd7"})]},e))}),(0,s.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,s.jsx)("input",{type:"text",value:O,onChange:e=>_(e.target.value),placeholder:r("addNewSubject"),className:"flex-1 border rounded px-2 py-1"}),(0,s.jsx)("button",{type:"button",className:"bg-[#25388C] text-white px-3 py-1 rounded",onClick:D,disabled:A,children:A?r("adding"):r("add")})]}),(0,s.jsx)(o.$,{className:"w-full bg-[#25388C] hover:bg-[#1e2e6d] text-white",onClick:()=>f(!1),children:r("done")})]})})]})}},6780:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\hengs\\\\Desktop\\\\fyp\\\\frontend\\\\app\\\\(dashboard)\\\\school\\\\classrooms\\\\[id]\\\\report-cards\\\\[reportCardId]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\classrooms\\[id]\\report-cards\\[reportCardId]\\page.tsx","default")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")},9556:(e,t,r)=>{"use strict";r.d(t,{C1:()=>f,KP:()=>x,Ko:()=>i,LP:()=>p,MV:()=>b,Nw:()=>E,QV:()=>N,Th:()=>$,VA:()=>d,VN:()=>c,bq:()=>S,dp:()=>u,ei:()=>g,fi:()=>n,kn:()=>k,m1:()=>j,nE:()=>l,nJ:()=>v,oC:()=>m,ot:()=>o,rq:()=>a,s5:()=>h,t:()=>C,uN:()=>w,zi:()=>y});let s="https://determined-passion-production-b403.up.railway.app/api",a=async()=>{let e=await fetch(`${s}/classrooms`,{headers:{}});if(!e.ok)throw Error("Failed to fetch classrooms");return e.json()},o=async e=>{let t=await fetch(`${s}/classrooms`,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create classroom");return t.json()},n=async(e,t)=>{let r=await fetch(`${s}/classrooms/${e}`,{method:"PATCH",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify({name:t})});if(!r.ok)throw Error("Failed to update classroom");return r.json()},i=async e=>{let t=await fetch(`${s}/classrooms/${e}/archive`,{method:"PATCH",headers:{}});if(!t.ok)throw Error("Failed to archive classroom");return t.json()},d=async()=>{let e=await fetch(`${s}/classrooms/archived`,{headers:{}});if(!e.ok)throw Error("Failed to fetch archived classrooms");return e.json()},l=async e=>{let t=await fetch(`${s}/classrooms/${e}/unarchive`,{method:"PATCH",headers:{}});if(!t.ok)throw Error("Failed to unarchive classroom");return t.json()},c=async()=>{let e=await fetch(`${s}/students`,{headers:{}});if(!e.ok)throw Error("Failed to fetch students");return e.json()},h=async e=>{let t=await fetch(`${s}/students`,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create student");return t.json()},u=async(e,t)=>{let r=await fetch(`${s}/students/${e}`,{method:"PUT",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to update student");return r.json()},p=async e=>{let t=await fetch(`${s}/students/${e}`,{method:"DELETE",headers:{}});if(!t.ok)throw Error("Failed to delete student");return t.json()},m=async e=>{let t=await fetch(`${s}/students/${e}`,{headers:{}});if(!t.ok)throw Error("Failed to fetch student");return t.json()},f=async e=>{let t=await fetch(`${s}/classrooms/${e}`,{headers:{}});if(!t.ok)throw Error("Failed to fetch classroom");return t.json()},x=async e=>{let t=await fetch(`${s}/classrooms/${e}/students`,{headers:{}});if(!t.ok)throw Error("Failed to fetch classroom students");return t.json()},b=async(e,t)=>{let r=await fetch(`${s}/classrooms/${e}/students`,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify({studentIds:t})});if(!r.ok)throw await r.json();return r.json()},y=async(e,t)=>{let r=await fetch(`${s}/classrooms/${e}/students/${t}`,{method:"DELETE",headers:{}});if(!r.ok)throw Error("Failed to remove student from classroom");return r.json()},g=async e=>{let t=await fetch(`${s}/report-cards/classrooms/${e}/report-cards`,{headers:{}});if(!t.ok)throw Error("Failed to fetch report cards");return t.json()},v=async(e,t)=>{let r=await fetch(`${s}/report-cards/classrooms/${e}/report-cards`,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify({title:t})});if(!r.ok)throw Error("Failed to create report card");return r.json()},j=async e=>{let t=await fetch(`${s}/report-cards/${e}`,{method:"DELETE",headers:{}});if(!t.ok)throw Error("Failed to delete report card");return t.json()},w=async(e,t)=>{let r=await fetch(`${s}/report-cards/${e}/scores`,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify({scores:t})});if(!r.ok)throw Error("Failed to save report card scores");return r.json()},k=async e=>{let t=await fetch(`${s}/report-cards/${e}/scores`,{headers:{}});if(!t.ok)throw Error("Failed to fetch report card scores");return t.json()},N=async(e,t)=>{let r=await fetch(`${s}/report-cards/${e}/send-sms`,{method:"POST",headers:Object.assign({"Content-Type":"application/json"},{}),body:JSON.stringify({studentIds:t})});if(!r.ok)throw Error("Failed to send SMS");return r.json()};async function C(){let e=localStorage.getItem("token"),t=await fetch(`${s}/user-subjects`,{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)throw Error("Failed to fetch custom subjects");return t.json()}async function $(e){let t=localStorage.getItem("token"),r=await fetch(`${s}/user-subjects`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({subject:e})});if(!r.ok)throw Error("Failed to add subject");return r.json()}async function S(e){let t=localStorage.getItem("token"),r=await fetch(`${s}/user-subjects`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({subject:e})});if(!r.ok)throw Error("Failed to delete subject");return r.json()}async function E(e,t){let r=localStorage.getItem("token"),a=await fetch(`${s}/report-cards/${e}/subjects`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({subjects:t})});if(!a.ok)throw Error("Failed to save report card subjects");return a.json()}}};var t=require("../../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,9,658,598,751,219,10,905],()=>r(4772));module.exports=s})();