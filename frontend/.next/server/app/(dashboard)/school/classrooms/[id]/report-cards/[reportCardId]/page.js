(()=>{var e={};e.id=283,e.ids=[283],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1978:(e,t,s)=>{Promise.resolve().then(s.bind(s,6522))},2594:(e,t,s)=>{Promise.resolve().then(s.bind(s,6780))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4772:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>i});var r=s(5239),a=s(8088),n=s(8170),l=s.n(n),d=s(893),o={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>d[e]);s.d(t,o);let i={children:["",{children:["(dashboard)",{children:["school",{children:["classrooms",{children:["[id]",{children:["report-cards",{children:["[reportCardId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6780)),"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\classrooms\\[id]\\report-cards\\[reportCardId]\\page.tsx"]}]},{}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6675)),"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\layout.tsx"]}]},{"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,8014)),"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,5284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,6055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\classrooms\\[id]\\report-cards\\[reportCardId]\\page.tsx"],p={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(dashboard)/school/classrooms/[id]/report-cards/[reportCardId]/page",pathname:"/school/classrooms/[id]/report-cards/[reportCardId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},6522:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(687),a=s(3210),n=s(4219),l=s(9556),d=s(6189),o=s(3921);function i(){let e=(0,d.useParams)();e.id;let t=e.reportCardId,{t:s}=(0,o.o)(),i=(0,a.useMemo)(()=>[s("khmerLiterature"),s("mathematics"),s("chemistry"),s("physics"),s("biology"),s("history")],[s]),[c,p]=(0,a.useState)([]),[x,h]=(0,a.useState)(!1),[u,m]=(0,a.useState)(i),[b,f]=(0,a.useState)([]),[g,y]=(0,a.useState)(!1),[v,j]=(0,a.useState)(null),[N,C]=(0,a.useState)(null),[w,k]=(0,a.useState)({}),[S,P]=(0,a.useState)(!1),[_,q]=(0,a.useState)([]),[I,A]=(0,a.useState)(""),[T,D]=(0,a.useState)(!1),E=e=>{m(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},G=e=>{f(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},U=(e,t,s)=>{k(r=>({...r,[e]:{...r[e],[t]:s}}))},z=async()=>{let e=I.trim();if(e&&!u.includes(e)&&!i.includes(e)&&!_.includes(e)){D(!0);try{await (0,l.Th)(e),q(t=>[...t,e]),m(t=>[...t,e]),A("")}catch{alert(s("failedToAddSubject"))}finally{D(!1)}}},M=async e=>{D(!0);try{await (0,l.bq)(e),q(t=>t.filter(t=>t!==e)),m(t=>t.filter(t=>t!==e))}catch{alert(s("failedToRemoveSubject"))}finally{D(!1)}},F=async()=>{P(!0);try{let e=[...u],r=c.map(t=>e.reduce((e,s)=>{let r=Number(w[t.id]?.[s]||0);return e+(isNaN(r)?0:r)},0)),a=[...r].map((e,t)=>({total:e,idx:t})).sort((e,t)=>t.total-e.total),n=Array(c.length).fill(0),d=1;for(let e=0;e<a.length;e++)e>0&&a[e].total===a[e-1].total?n[a[e].idx]=n[a[e-1].idx]:n[a[e].idx]=d,d++;let o={};c.forEach((t,s)=>{let a=r[s],l=e.length>0?(a/e.length).toFixed(2):"0",d=n[s];o[t.id]={...w[t.id],total:String(a),average:String(l),rank:String(d)}}),await (0,l.uN)(t,o),alert(s("successfullySavedScores"))}catch(e){alert(s("failedToSaveScores"))}finally{P(!1)}},R=[...u];return(0,r.jsxs)("section",{className:"w-full rounded-2xl bg-white p-7",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold",children:N?.title||s("reportCard")}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(n.$,{className:"bg-[#25388C] hover:bg-[#1e2e6d] text-white",onClick:()=>h(!0),children:s("selectSubjects")}),(0,r.jsx)(n.$,{className:"bg-[#25388C] hover:bg-[#1e2e6d] text-white",onClick:F,disabled:S,children:S?s("saving"):s("save")})]})]}),v&&(0,r.jsx)("div",{className:"text-red-500 mb-4",children:v}),(0,r.jsx)("div",{className:"overflow-x-auto rounded-xl border border-gray-200 shadow-sm",children:(0,r.jsxs)("table",{className:"min-w-full text-sm text-left",children:[(0,r.jsx)("thead",{className:"bg-[#6C6F7F] text-white uppercase text-xs",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-3",children:(0,r.jsx)("input",{type:"checkbox",checked:g,onChange:()=>y(e=>!e)})}),(0,r.jsx)("th",{className:"px-4 py-3",children:s("name")}),(0,r.jsx)("th",{className:"px-4 py-3",children:s("absent")}),R.map(e=>(0,r.jsx)("th",{className:"px-4 py-3",children:e},e)),(0,r.jsx)("th",{className:"px-4 py-3",children:s("total")}),(0,r.jsx)("th",{className:"px-4 py-3",children:s("average")}),(0,r.jsx)("th",{className:"px-4 py-3",children:s("grade")}),(0,r.jsx)("th",{className:"px-4 py-3",children:s("ranking")})]})}),(0,r.jsx)("tbody",{children:(()=>{let e=c.map(e=>R.reduce((t,s)=>{let r=Number(w[e.id]?.[s]||0);return t+(isNaN(r)?0:r)},0)),t=[...e].map((e,t)=>({total:e,idx:t})).sort((e,t)=>t.total-e.total),s=Array(c.length).fill(0),a=1;for(let e=0;e<t.length;e++)e>0&&t[e].total===t[e-1].total?s[t[e].idx]=s[t[e-1].idx]:s[t[e].idx]=a,a++;return c.map((t,a)=>{let n=e[a],l=R.length>0?(n/R.length).toFixed(2):"0",d=s[a];return(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsx)("td",{className:"px-4 py-2",children:(0,r.jsx)("input",{type:"checkbox",checked:b.includes(t.id),onChange:()=>G(t.id)})}),(0,r.jsx)("td",{className:"px-4 py-2",children:t.name}),(0,r.jsx)("td",{className:"px-4 py-2 text-center",children:(0,r.jsx)("input",{type:"text",className:"w-16 border rounded px-1 py-0.5 text-center",value:w[t.id]?.absent||"",onChange:e=>U(t.id,"absent",e.target.value)})}),R.map(e=>(0,r.jsx)("td",{className:"px-4 py-2 text-center",children:(0,r.jsx)("input",{type:"text",className:"w-16 border rounded px-1 py-0.5 text-center",value:w[t.id]?.[e]||"",onChange:s=>U(t.id,e,s.target.value)})},e)),(0,r.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:n}),(0,r.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:l}),(0,r.jsx)("td",{className:"px-4 py-2 text-center",children:(0,r.jsx)("input",{type:"text",className:"w-16 border rounded px-1 py-0.5 text-center",value:w[t.id]?.grade||"",onChange:e=>U(t.id,"grade",e.target.value)})}),(0,r.jsx)("td",{className:"px-4 py-2 text-center font-semibold",children:d})]},t.id)})})()})]})}),(0,r.jsx)(n.$,{className:"mt-8 bg-[#25388C] hover:bg-[#1e2e6d] text-white font-semibold rounded-xl py-2 px-3 text-base",style:{minWidth:160},onClick:async()=>{try{await (0,l.QV)(t,b.length>0?b:c.map(e=>e.id)),alert(s("smsSentToParents"))}catch{alert(s("failedToSendSMS"))}},children:s("send")}),x&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-black/30 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-lg w-[400px] max-w-[90vw] relative",children:[(0,r.jsx)("button",{className:"absolute top-4 right-4 text-gray-400 hover:text-black text-3xl",onClick:()=>h(!1),children:"\xd7"}),(0,r.jsx)("div",{className:"font-bold text-lg text-center mb-6",children:s("selectSubjects")}),(0,r.jsx)("div",{className:"flex flex-col gap-2 mb-4",children:[...i,..._].map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:u.includes(e),onChange:()=>E(e)}),(0,r.jsx)("span",{children:e}),_.includes(e)&&(0,r.jsx)("button",{type:"button",className:"ml-2 text-xs text-red-400 hover:text-red-600",onClick:()=>M(e),title:s("removeCustomSubject"),disabled:T,children:"\xd7"})]},e))}),(0,r.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,r.jsx)("input",{type:"text",value:I,onChange:e=>A(e.target.value),placeholder:s("addNewSubject"),className:"flex-1 border rounded px-2 py-1"}),(0,r.jsx)("button",{type:"button",className:"bg-[#25388C] text-white px-3 py-1 rounded",onClick:z,disabled:T,children:T?s("adding"):s("add")})]}),(0,r.jsx)(n.$,{className:"w-full bg-[#25388C] hover:bg-[#1e2e6d] text-white",onClick:()=>h(!1),children:s("done")})]})})]})}},6780:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(2907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\hengs\\\\Desktop\\\\fyp\\\\frontend\\\\app\\\\(dashboard)\\\\school\\\\classrooms\\\\[id]\\\\report-cards\\\\[reportCardId]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\hengs\\Desktop\\fyp\\frontend\\app\\(dashboard)\\school\\classrooms\\[id]\\report-cards\\[reportCardId]\\page.tsx","default")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,9,658,598,751,219,648,610],()=>s(4772));module.exports=r})();